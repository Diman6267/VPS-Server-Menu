#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ IPv6.

echo "--- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ IPv6 ---"
echo ""

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —è–¥—Ä–∞ (–ì–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)
KERNEL_STATUS=$(cat /proc/sys/net/ipv6/conf/all/disable_ipv6)

if [ "$KERNEL_STATUS" -eq 1 ]; then
    echo "‚öôÔ∏è  –°—Ç–∞—Ç—É—Å —è–¥—Ä–∞ (disable_ipv6): 1 (–û—Ç–∫–ª—é—á–µ–Ω)"
else
    echo "‚öôÔ∏è  –°—Ç–∞—Ç—É—Å —è–¥—Ä–∞ (disable_ipv6): 0 (–í–∫–ª—é—á–µ–Ω)"
fi

echo "---"

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
ACTIVE_ADDRESSES=$(ip a | grep inet6 | grep -v '::1/128' | wc -l)

if [ "$ACTIVE_ADDRESSES" -gt 0 ]; then
    echo "üåê  –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–¥—Ä–µ—Å–∞: –ù–ê–ô–î–ï–ù–´"
    echo "   (–ù–∞–π–¥–µ–Ω–æ $ACTIVE_ADDRESSES –Ω–µ-loopback –∞–¥—Ä–µ—Å–æ–≤)"
    echo ""
    ip a | grep inet6 | grep -v '::1/128'
else
    echo "üåê  –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–¥—Ä–µ—Å–∞: –ù–ï –ù–ê–ô–î–ï–ù–´"
fi

echo ""
echo "--- –ì–æ—Ç–æ–≤–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 'ipv6-on' –∏–ª–∏ 'ipv6-off' –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è."
